"use strict";define(function(require){var app=require("app");require("./services/appService"),app.controller("ComponentCtrl",["$rootScope","$scope","config","appService","http",function($rootScope,$scope,config,appService,http){var vm=$scope.vm;angular.extend(vm,{componentInit:function(){var normal_module_config=config.component,card_module_config=config.card_module,ui=vm.currentModuleInfo.ui,name=vm.currentModuleInfo.name;vm.componenttpl=config.component;var data=vm.appData;if(vm.listui=data.module_style[vm.moduleId],normal_module_config[ui]&&"ListUI10"!=ui&&!card_module_config[ui]){var obj={};obj=angular.copy(vm.listui),delete obj.components,obj.name=name,obj.itemName=ui,obj.itemCount=4,vm.listui.components=[],vm.listui.components.push(obj)}card_module_config[ui]||this.initComponents(),vm.navbar=data.main_ui.menu&&data.main_ui.menu.navBar;var _this=this;$scope.$watch("vm.bigViews",function(json){json&&!_.isEmpty(json)&&_this.formatComponents(json)},!0),$scope.$on("filter_list_item_change",function(event,length){angular.forEach(vm.listui.components,function(component,index){"filter_menu"==component.itemName&&(component.filter_menu_item_count=length)})})},formatComponents:function(json){angular.forEach(vm.listui.components,function(component,index){component.view_id&&(vm.listui.components[index]=angular.extend(component,json[component.view_id]))})},initComponents:function(){angular.forEach(vm.listui.components,function(component,index){if(component.view_id){var url=config.getAdminAPI("getviewList").replace("{view_id}",component.view_id);http(url).then(function(json){vm.listui.components[index]=angular.extend(component,json.result[component.view_id])})}})}}),vm.componentInit()}])});
"use strict";define(function(require){var app=require("app");require("common/services/modelService"),require("common/modal/modal-header"),require("common/modal/modal-footer"),app.controller("editExtendData",["$scope","$mdDialog","http","config","utils","data",function($scope,$mdDialog,http,config,utils,data){var vm=$scope.vm={};console.log("扩展字段编辑对象: ",data),angular.extend(vm,{init:function(){this.initParams()},initParams:function(){data&&!_.isEmpty(data)&&(vm.current_field={field:data.field,field_type:data.field_type,is_enabled:data.is_enabled,name:data.name}),vm.field_type_name=data.field_type_name,vm.field_typelist=[{slug:"string",name:"字符"},{slug:"date",name:"日期"},{slug:"image",name:"图片"},{slug:"int",name:"整数"}]},TypeSelect:function(item){vm.field_type_name=item.name,vm.current_field.field_type=item.slug},close:function(){$mdDialog.cancel()},save:function(){if(""===vm.current_field.name)return void utils.error("请填写名称!");if(""===vm.current_field.fieldType)return void utils.error("请选择类型!");var url=config.getAdminAPI("addextend"),extendDataParams={new_version:!0,fields:[vm.current_field]};console.log("修改拓展字段参数: ",extendDataParams),http(url,{method:"post",data:extendDataParams}).then(function(data){data&&"0"===data.error_code&&utils.success("修改成功").then(function(){$mdDialog.hide()})})}}),vm.init()}])});

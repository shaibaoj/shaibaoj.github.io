"use strict";define(function(require){var app=require("app");require("common/services/modelService"),require("common/modal/modal-header"),require("common/modal/modal-footer"),app.controller("AddExtendData",["$scope","$mdDialog","http","config","utils",function($scope,$mdDialog,http,config,utils){var vm=$scope.vm={};angular.extend(vm,{init:function(){this.initParams()},initParams:function(){vm.current_field={field:utils.randomString(10),field_type:"",name:"",is_enabled:!1},vm.field_type_name="",vm.field_typelist=[{slug:"string",name:"字符"},{slug:"date",name:"日期"},{slug:"image",name:"图片"},{slug:"int",name:"整数"}]},TypeSelect:function(item){vm.field_type_name=item.name,vm.current_field.field_type=item.slug},close:function(){$mdDialog.cancel()},save:function(){if(""===vm.current_field.name)return void utils.error("请填写名称!");if(""===vm.current_field.fieldType)return void utils.error("请选择类型!");var url=config.getAdminAPI("addextend").replace("{guid}",vm.guid),extendDataParams={new_version:!0,fields:[vm.current_field]};http(url,{method:"post",data:extendDataParams}).then(function(data){data&&"0"===data.error_code&&utils.success("新建成功").then(function(){$mdDialog.hide(extendDataParams.fields[0])})})}}),vm.init()}])});

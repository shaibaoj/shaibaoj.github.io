"use strict";define(function(require){var app=require("app");app.factory("moduleMarket",["$q","config","http",function($q,config,http){return{selectTag:{},getProductList:function(type,parent,child,page){var _this=this,url=config.getAPI("template_system.productlist").replace("{type}",type);return url+=_this.handelUrl(parent,child),url&&page&&page.current&&(url=this.operatPage(url,page)),console.log(url,"url"),http(url)},handelUrl:function(parent,child){var _this=this,_url="";return parent&&"price"!==parent.id&&(_this.selectTag[parent.id]=child.slug),parent&&"price"===parent.id&&(_this.selectTag[parent.id]=child.name),parent&&parent.id===-1&&(_this.selectTag={}),console.log(_this.selectTag,"_this.selectTag"),angular.forEach(_this.selectTag,function(value){parent&&"price"!=parent.id&&"all"!=value?_url.indexOf("?")==-1?_url=_url+"?tags="+encodeURIComponent(value):_url+=encodeURIComponent(","+value):parent&&"price"==parent.id&&"all"!=value&&(_url=_url?_url+"&"+_this.priceSelect(child,value):"?"+_this.priceSelect(child,value))}),_url},operatPage:function(url,page){var _url_="";return console.log(page,"page"),_url_=url.indexOf("?")==-1?url+"?page="+page.current+"&count="+page.item:url+"&page="+page.current+"&count="+page.item},priceSelect:function(child,string){return string="min_price"+child.name.split("-")[0]+"&max_price="+child.name.split("-")[1]},getProductDetial:function(product_id){var url=config.getAPI("template_system.productdetial").replace("{product_id}",product_id);return http(url)},getProductTag:function(){var url=config.getAPI("template_system.tagslist");return http(url)}}}])});
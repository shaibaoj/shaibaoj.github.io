"use strict";define(function(require){var app=require("app");app.directive("dingdoneWidgetGlobalBar",function(utils,config,http,PageDesignService,$compile,$timeout){return{scope:{widget:"="},replace:!0,templateUrl:"common/directives/superui/global_bar.html",link:function($scope,el,attrs,parentCtrl){var vm=$scope.vm={};angular.extend(vm,{globalViewId:"",init:function(){A.forEach($scope.widget.VIEWS,function(view){"page_style"==view.view&&(view.global_back_btn?vm.globalViewId=view.global_back_btn:(vm.getGlobalViewId(),$timeout(function(){view.global_back_btn=vm.globalViewId},0)))})},getGlobalViewId:function(){PageDesignService.getWeightViewId("system_back_btn").then(function(json){vm.globalViewId=json.app_view_id,$scope.widget.VIEWS[vm.globalViewId]=json.default_attrs})},toggleBtn:function(){vm.attributeValues=$scope.widget.VIEWS[vm.globalViewId],PageDesignService.getFormScheme("system_back_btn").then(function(json){vm.formScheme=json,vm.currentShow=!vm.currentShow;var dom='<dingdone-widget form-scheme="vm.formScheme" attribute-values="vm.attributeValues" dynamic-compile="true" page-id="vm.pageId" page-model-id="vm.pageModelId" callback="vm.previewCallback( info )"></dingdone-widget>';$compile(dom)($scope).appendTo(el.find(".dingdone-widget-placeholder").empty())})}}),vm.init()}}})});
"use strict";define(function(require){var app=require("app");app.directive("dingdoneWidgetFieldBind",function($compile){return{scope:{widget:"=",children:"="},replace:!0,templateUrl:"common/directives/superui/field_bind.html",require:"?^dingdoneWidgetItem",link:function($scope,el,attrs,dingdoneWidgetItem){var vm=$scope.vm={};angular.extend(vm,{fieldsList:[],currentField:null,data_type:$scope.widget.data_type,init:function(){var _this=this;this.value=dingdoneWidgetItem.getValue(),this.value&&(this.currentField=_.find(this.fieldsList,function(field){return field.key==_this.value}))},selectField:function(field){this.currentField=field,dingdoneWidgetItem.setValue(field.key)}}),$scope.$on("refreshFields",function(event,fieldsList){var data_type=vm.data_type;vm.fieldsList=_.filter(fieldsList,function(field){return _.indexOf(data_type,field.data_type)>-1}),vm.init()})}}})});
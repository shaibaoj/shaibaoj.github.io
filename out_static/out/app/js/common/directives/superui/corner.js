"use strict";define(function(require){var app=require("app");app.directive("dingdoneWidgetCorner",["mathService","config",function(mathService,config){return{scope:{widget:"="},replace:!0,templateUrl:"common/directives/superui/corner.html",require:"?^dingdoneWidgetItem",link:function($scope,el,attrs,dingdoneWidgetItem){var vm=$scope.vm={};angular.extend(vm,{isShow:!1,effectPreview:{},direction:{left_top:{key:"border-top-left-radius",name:"左上"},right_top:{key:"border-top-right-radius",name:"右上"},left_bottom:{key:"border-bottom-left-radius",name:"左下"},right_bottom:{key:"border-bottom-right-radius",name:"右下"}},width:{},colorpickerOption:angular.copy(config.colorpickerDefault),init:function(){var value=dingdoneWidgetItem.getValue();for(var directionKey in value)if(vm.direction[directionKey]){var cssKey=vm.direction[directionKey].key;vm.effectPreview[cssKey]=value[directionKey]+"px",vm.width[directionKey]=value[directionKey]}vm.enabled=!!value&&value.enabled,this.renderBox()},minusEnable:function(){return mathService.subtract(this.value,$scope.widget.step)>=$scope.widget.min},plusEnable:function(){return mathService.add(this.value,$scope.widget.step)<=$scope.widget.max},minus:function(){if(this.minusEnable()){var alreadyMin=this.value<=$scope.widget.min;this.value=alreadyMin?$scope.widget.min:mathService.subtract(this.value,$scope.widget.step)}},plus:function(){if(this.plusEnable()){var alreadyMax=this.value>=$scope.widget.max;this.value=alreadyMax?$scope.widget.max:mathService.add(this.value,$scope.widget.step)}},toggle:function(){vm.isShow=!vm.isShow},check:function(directionKey){this.refreshView()},renderBox:function(){if(vm.enabled){var cssKey="";for(var directionKey in vm.direction)vm.direction[directionKey]&&(cssKey=vm.direction[directionKey].key,vm.effectPreview[cssKey]=vm.width[directionKey]+"px")}else vm.effectPreview={"border-radius":"none"}},refreshView:function(){this.renderBox(),dingdoneWidgetItem.setValue({enabled:vm.enabled,left_bottom:vm.width.left_bottom,right_bottom:vm.width.right_bottom,right_top:vm.width.right_top,left_top:vm.width.left_top},null,!0)}}),vm.init()}}}])});
"use strict";define(function(require){var app=require("app");require("uploadify"),app.directive("dingdoneUploadify",function(){return{require:"?ngModel",scope:{uploadConfig:"=",uploadSuccess:"&"},restrict:"A",link:function link($scope,element,attrs,ngModel){$scope.$watch("uploadConfig",function(newValue,oldValue,scope){var opts=angular.extend({},newValue);element.uploadify({formData:{},fileObjName:opts.fileObjName||"upfile",fileTypeDesc:"all",auto:void 0==opts.auto||opts.auto,swf:opts.swf||"dist/images/uploadify.swf",uploader:opts.uploader,buttonText:opts.buttonText||"本地文件",width:opts.width||100,height:opts.height||40,fileSizeLimit:opts.allow_max_size,fileTypeExts:opts.allow_file_type,onUploadStart:function(file){element.uploadify("settings","formData",{media_file:file,model_id:opts.model_id,fileTypeExts:"*.gif; *.jpg; *.png"})},onUploadSuccess:function onUploadSuccess(file,d,response){if(ngModel){var result=eval("["+d+"]")[0];$scope.$apply(function(){ngModel.$setViewValue(result.url)}),$scope.uploadSuccess&&$scope.uploadSuccess({flag:"success"})}}})},!0)}}})});

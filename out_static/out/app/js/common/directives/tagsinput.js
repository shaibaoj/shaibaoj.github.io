"use strict";define(function(require){var app=require("app");app.directive("tagsinput",function(utils,$timeout){return{restrict:"E",scope:{value:"=",callback:"&"},templateUrl:"common/directives/tagsinput.html",replace:!0,link:function(scope,element,attrs,ctrl){element.on("click",".close",function(){$(this).parent().hide()}),scope.$watch("value",function(newvalue){newvalue&&scope.value&&(scope.tags=scope.value)}),scope.tags=scope.value||[],scope.removeTag=function($index){scope.tags.splice($index,1),scope.value=scope.tags},scope.addTag=function(){scope.currentTag&&$.inArray(scope.currentTag,scope.tags)===-1?(scope.tags.push(scope.currentTag),scope.currentTag="",scope.value=scope.tags,scope.callback()):$.inArray(scope.currentTag,scope.tags)!==-1&&utils.error("已经存在相同关键字!")},element.on("keyup",".add-tagsinput",function($event){var _this=$(this);if(13===$event.which){var val=$(this).val().trim();console.log(val,val.length),val&&$.inArray(val,scope.tags)===-1?scope.$apply(function(){scope.tags.push(val),_this.val(""),scope.value=scope.tags,scope.callback()}):$.inArray(val,scope.tags)!==-1&&utils.error("已经存在相同关键字!")}})}}})});

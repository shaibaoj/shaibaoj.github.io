"use strict";define(function(require){var app=require("app");require("common/modal/modal-header"),require("common/modal/modal-footer"),app.controller("LogisticsInfoModalCtrl",["$scope","utils","config","http","$mdDialog","order",function($scope,utils,config,http,$mdDialog,order){var vm=$scope.vm={};angular.extend(vm,{order:order,init:function(){vm.logistics={},vm.loading=!0,vm.getLogisticsName(),vm.delivery={}},refundLogisticsInfo:function(){vm.loading=!1,vm.logistics={name:vm.currentCompany,number:vm.express_number};var url=config.getAPI("step2","json");http(url,{params:vm.logistics}).then(function(data){0==data.error_code&&(vm.loading="complete",vm.order.refundconfirm=!1)})},getLogisticsName:function(){var url=config.getAPI("logistics","json");http(url).then(function(data){vm.logisticsname=data.result.logistics})},updateDelivery:function(){if(!vm.currentCompany)return void utils.error("请选择物流承运公司");if(!vm.express_number)return void utils.error("请输入物流单号");vm.delivery={company:vm.currentCompany,express_number:vm.express_number,order_no:vm.order.order_no},vm.loading=!1;var url=config.getAPI("setdelivery");http(url,{method:"post",data:vm.delivery}).then(function(resp){+resp.error_code||vm.hide(vm.delivery),vm.loading="complete"})["catch"](function(){vm.hide(vm.delivery),vm.loading="complete"})},save:function(){this.updateDelivery()},hide:function(data){$mdDialog.hide(data)},cancel:function(){$mdDialog.cancel()}}),vm.init()}])});

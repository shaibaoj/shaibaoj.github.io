var vmActivity=new Vue({el:"#vmActivity",mixins:[vmminxShopData],data:{category:[],categoryId:0,categoryCount:"",maxPrice:"",maxCouponmoney:"",maxTkrates:"",maxItemsale:"",typeArr:[1,0,2],activityType:0,plan:11},created:function(){},mounted:function(){this.categoryFun(),this.shopList()},methods:{categoryFun:function(){var self=this;ajaxPost("/api/common/channel/items",{},function(res){0==res.info.status?(self.category=res.data.items,self.$nextTick(function(){})):layer.msg(res.info.status_err,{time:2e3,shade:.1,shadeClose:!0})},function(){layer.msg("网络错误，请检查网络重试",{time:2e3,shade:.1,shadeClose:!0})})},categoryCountFun:function(){var self=this;ajaxPost("/api/common/channel/items",{cat_id:self.categoryId,max_price:self.maxPrice,max_couponmoney:self.maxCouponmoney,max_tkrates:self.maxTkrates,max_itemsale:self.maxItemsale,type:self.activityType},function(data){"200"==data.code&&(self.categoryCount=data.data)})},categoryBtn:function(id){this.categoryId=id,this.regChoice()},shopList:function(){var self=this;this.publicList.productList[0]&&this.publicList.productList.forEach(function(item,index){item.itempic=""}),self.oPublic.setTimeoutClear=setTimeout(function(){self.oPublic.loadingShow=!0},self.oPublic.setTime);var shopUrl="/api/common/activity/list",para={plan:self.plan,cid:self.categoryId,ipage:self.publicList.pageNumber,max_price:self.maxPrice,max_couponmoney:self.maxCouponmoney,max_tkrates:self.maxTkrates,max_itemsale:self.maxItemsale,type:self.activityType};0==self.activityType?(shopUrl="/api/common/activity/goods",para=Object.assign(para,{activity_type:11,sort:"day_sales"})):2==self.activityType&&(shopUrl=null),shopUrl&&ajaxPost(shopUrl,para,function(data){0==data.info.status&&(self.publicList.productList=data.data.items,self.publicList.count=0==data.data.pager.page_count?1:data.data.pager.page_count,self.categoryCount=0==data.data.pager.count?1:data.data.pager.count,self.$nextTick(function(){clearTimeout(self.oPublic.setTimeoutClear),self.oPublic.loadingShow=!1,self.oPublic.wholeShow=!0,0<self.publicList.productList.length?(self.oPublic.isDatanull=!1,self.echoImg(),self.paginationFun(self.publicList.pageNumber)):(layer.msg("暂无数据",{time:2e3,shade:.1,shadeClose:!0}),self.oPublic.isDatanull=!0)}))})},paginationFun:function(isPage){var self=this;$(".inPage").pagination({pageCount:self.publicList.count,current:isPage,prevContent:"<<",nextContent:">>",count:4,callback:function(api){self.publicList.pageNumber=api.getCurrent(),self.publicList.pageInput=self.publicList.pageNumber,self.arrowTopFuns(),self.shopList()}})},PageJump:function(){this.publicList.pageNumber=this.publicList.count,this.publicList.pageInput=this.publicList.count,this.arrowTopFuns(),this.shopList(),this.paginationFun(this.publicList.count)},pageSureBtn:function(){""==this.publicList.pageInput&&(this.publicList.pageInput=1),this.publicList.pageNumber=parseInt(this.publicList.pageInput),this.paginationFun(this.publicList.pageInput),this.arrowTopFuns(),this.shopList()},regChoice:function(){this.publicList.pageNumber=1,this.publicList.pageInput=1,this.shopList()},arrowTopFuns:function(){document.documentElement.scrollTop=564},typeClick:function(type){this.activityType=type,this.categoryId=0,this.categoryCount="",this.maxPrice="",this.maxCouponmoney="",this.maxTkrates="",this.maxItemsale="",this.regChoice()}}});
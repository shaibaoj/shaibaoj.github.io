var vmHTTPurl=window.location.protocol.substring(0,window.location.protocol.length-1),vmHostUrl="haopintui"==window.location.host.split(".")[1]?"haopintui.net":window.location.host.split(".")[1]+"."+window.location.host.split(".")[2],vmComData={vmUrl:URLPrefix.api_url},vmTestInput={isPhoneNo:function(phone){return"/^1[3456789]d{9}$/".test(phone)},isNumber:function(number){return"/^[0-9]*$/".test(number)},isQQ:function(qq){return"/^[1-9][0-9]{4,14}/".test(qq)},vmPageAll:function(str){setTimeout(function(){window.open(str)},20)}},vmUrlSearchs=null;function vmRequest(name){return(vmUrlSearchs=vmUrlSearchs||new vmUrlSearch)[name]}function vmUrlSearch(){for(var name,value,str=location.href,num=str.indexOf("?"),arr=(str=str.substr(num+1)).split("&"),i=0;i<arr.length;i++)0<(num=arr[i].indexOf("="))&&(name=arr[i].substring(0,num),value=arr[i].substr(num+1),this[name]=value)}var vmAjaxGet=function(site,data,successfun,errorfun){var temp_errorfun=function(xhr,type){};errorfun&&(temp_errorfun=errorfun),$.ajax({type:"GET",url:vmComData.vmUrl+site,data:Object.assign(data,{times:URLPrefix.times,url_sign:URLPrefix.url_sign,member_token:URLPrefix.token}),dataType:"json",timeout:3e4,success:successfun,error:temp_errorfun,xhrFields:{withCredentials:!0}})},vmAjaxPost=function(site,data,successfun,errorfun){var temp_errorfun=function(xhr,type){};errorfun&&(temp_errorfun=errorfun),$.ajax({type:"POST",url:vmComData.vmUrl+site,data:Object.assign(data,{times:URLPrefix.times,url_sign:URLPrefix.url_sign,member_token:URLPrefix.token}),dataType:"json",timeout:3e4,success:successfun,error:temp_errorfun,xhrFields:{withCredentials:!0}})},vmAjaxGetJsonp=function(site,data,successfun,errorfun){var temp_errorfun=function(xhr,type){};errorfun&&(temp_errorfun=errorfun),$.ajax({type:"GET",url:vmComData.vmUrl+site,data:Object.assign(data,{times:URLPrefix.times,url_sign:URLPrefix.url_sign,member_token:URLPrefix.token}),dataType:"jsonp",timeout:3e4,success:successfun,error:temp_errorfun,xhrFields:{withCredentials:!0}})},vmminxShopData={data:{oPublic:{reportImg:"",loadingImg:"//shaibaoj.gitee.io/app_static/images/web/common/loading.png",loadingShow:!1,wholeShow:!1,setTimeoutClear:"",setTime:300,isDatanull:!1,offsetTop:""},publicList:{productList:"",pageNumber:1,pageInput:1,count:""},oHidePopup:{hideOnLineLin:!1,hideEchartCheck:!1},oToken:{token:"",toeknTime:"",toeknBoolean:!1},oGetTop:{getTopData:[]}},created:function(){},mounted:function(){},filters:{numText:function(number){return number<1e4?number:1e4<=number?Math.round(number/1e4*100)/100+"万":void 0},conversion:function(number){if(number){if(number.length<=4)return number;if(5<=number.length)return Math.round(number/1e4*100)/100+"万"}}},watch:{"publicList.pageInput":function(newValue){newValue>this.publicList.count&&(this.publicList.pageInput=this.publicList.count),newValue<1&&""!=newValue&&(this.publicList.pageInput=1)}},methods:{getonFun:function(data){var JsonData,self=this,commodityData={},dataArr=[];for(i=0,len=data.length;i<len;i++)commodityData={id:data[i].id,cid:data[i].fqcat},dataArr.push(commodityData);JsonData=JSON.stringify(dataArr),vmAjaxPost("/indexapi/get_top_list",{request_json:JsonData},function(data){if("200"==data.status){var objData={};for(var j in data.request_array)objData[data.request_array[j].id]=data.request_array[j];self.oGetTop.getTopData=objData}},function(){})},producLink:function(id){vmTestInput.vmPageAll("https://detail.tmall.com/item.htm?id="+id)},ReportreadFile:function(event){var self=this,file=event.target.files[0];if(file){if(!/image\/\w+/.test(file.type))return layer.msg("文件必须为图片哦！",{icon:2}),!1;if(512e4<=file.size)return void layer.msg("图片大小过大，应小于5M！",{icon:2});var reader=new FileReader;reader.readAsDataURL(file),reader.onload=function(e){self.QiniuUpload(file,self.oToken.token),self.oPublic.reportImg=this.result}}},ajaxGetToken:function(){var self=this;self.oToken.toeknBoolean||vmAjaxPost("/indexapi/get_qiniu_token",{},function(data){"200"==data.status?(self.oToken.token=data.qiniu_token,self.oToken.toeknBoolean=!0,clearTimeout(self.oToken.toeknTime),self.setIntervalFun()):(clearTimeout(self.oToken.toeknTime),self.oToken.toeknBoolean=!1,self.oToken.token="")},function(){clearTimeout(self.oToken.toeknTime),self.oToken.toeknBoolean=!1})},setIntervalFun:function(){var self=this;this.oToken.toeknTime=setInterval(function(){self.oToken.toeknBoolean=!1},3e5)},QiniuUpload:function(f,token){var formData,startDate,taking,self=this,Qiniu_UploadUrl=vmHTTPurl+"://up.qbox.me",xhr=new XMLHttpRequest;xhr.open("POST",Qiniu_UploadUrl,!0),(formData=new FormData).append("token",token),formData.append("file",f),xhr.upload.addEventListener("progress",function(evt){if(evt.lengthComputable){var nowDate=(new Date).getTime();taking=nowDate-startDate;var uploadSpeed=evt.loaded/1024/(taking/1e3);1024<uploadSpeed?(uploadSpeed/1024).toFixed(2)+"Mb/s":uploadSpeed.toFixed(2)+"Kb/s";Math.round(100*evt.loaded/evt.total)}},!1),xhr.onreadystatechange=function(response){if(4==xhr.readyState&&200==xhr.status&&""!=xhr.responseText){var urlLink=JSON.parse(xhr.responseText).hash;self.oPublic.reportImg=urlLink}else 200!=xhr.status&&xhr.responseText},startDate=(new Date).getTime(),xhr.send(formData)},widthFun:function(item){return 0!=item.down_type?"width:0%":"width:"+Math.round(item.couponreceive/item.couponnum*100)+"%"},pageSkipp:function(id){vmTestInput.vmPageAll("/quan/"+id)},moveinIcon:function(name,event){layer.tips(name,$(event.target),{time:0,tips:[2,"#4d77ff"]})},ComremoveLayerTips:function(){var index=layer.tips();layer.close(index)},inCopywriting:function(event){var copy=$(event.target).attr("datatips");layer.tips(copy,$(event.target),{time:0,tips:[2,"#5cadff"],area:"440px"})},copywritingBtn:function(){var clipboard=new ClipboardJS(".public-copy",{target:function(){return document.querySelector(".layui-layer-content")}});clipboard.on("success",function(e){layer.msg("已复制",{time:1500}),e.clearSelection(),clipboard.destroy()}),clipboard.on("error",function(e){layer.msg("由于您的浏览器不兼容或当前网速较慢，复制失败，请手动复制或更换主流浏览器！",{icon:2})})},arrowTopFun:function(){$("body,html").stop(!0,!0).animate({scrollTop:0})},echartCheckFunBtn:function(itemid){this.oHidePopup.hideEchartCheck=!0,this.publicPopup(".js-popupEcharts"),echartCheckFun(itemid)},echartCheckShut:function(){this.oHidePopup.hideEchartCheck=!1,this.publicClose()},onLineLinBtn:function(itemId){this.oHidePopup.hideOnLineLin=!0,this.publicPopup(".js-popupOnLineLin"),onLineLinFun(itemId)},onLineLinShut:function(){this.oHidePopup.hideOnLineLin=!1,this.publicClose()},echoImg:function(){Echo.init({offset:0,throttle:0})},publicPopup:function(className){layer.open({type:1,shift:0,title:!1,closeBtn:0,shade:.4,content:$(className)})},publicClose:function(){layer.closeAll()}}};Vue.component("component-report",{mixins:[vmminxShopData],props:["dyajaxurl"],data:function(){return{oPublic:{reportImg:""},oHidePopup:{hideJb:!1},oReport:{reportLSelected:0,reportL:"",reportQQ:"",isId:"",oIndex:""},oReportSelected:[{id:0,describe:"请选择理由"},{id:1,describe:"首页评论有拉人信息"},{id:2,describe:"低佣或关闭佣金"},{id:3,describe:"优惠券无法使用"},{id:4,describe:"商家发短信或返现卡加微信拉人"},{id:5,describe:"价格不符"},{id:6,describe:"文案不符"},{id:7,describe:"商品已下架"},{id:8,describe:"有更高优惠券"},{id:9,describe:"涉嫌刷榜"},{id:10,describe:"其他"}],oToken:{token:"",toeknTime:"",toeknBoolean:!1}}},methods:{jbPrdoucBtn:function(item,index,number){1!=item.report_status&&100!=item.report_status?(this.oReport.isId=item.id,this.oReport.oIndex=index,this.oHidePopup.hideJb=!0,this.publicPopup(".js-PopupReport"),this.ajaxGetToken()):layer.msg("该宝贝已被举报过，待处理中",{icon:5})},getCouponSelected:function(id){if(0!=id)return 8==id?(layer.msg("请输入更高优惠券链接或联系群管理员"),void(this.oReport.reportL="")):void(this.oReport.reportL=this.oReportSelected[id].describe);this.oReport.reportL=""},ReportBtn:function(){var self=this;if(0!=self.oReport.reportLSelected)if(""!=self.oReport.reportL||8==self.oReport.reportLSelected)if(8!=self.oReport.reportLSelected||""!=self.oReport.reportL)if(""!=self.oReport.reportQQ)if(""!=self.oPublic.reportImg||3==self.oReport.reportLSelected||10==self.oReport.reportLSelected){var url=self.dyajaxurl?"/indexapi/trill_report":"/indexapi/report";vmAjaxPost(url,{id:self.oReport.isId,report_type:self.oReport.reportLSelected,report_reason:self.oReport.reportL,report_qq:self.oReport.reportQQ,report_image:self.oPublic.reportImg},function(data){"200"==data.status?(self.jbPrdoucShut(),layer.msg(data.message,{icon:1,time:2e3})):(self.jbPrdoucShut(),layer.msg(data.message,{icon:2,time:2e3}))},function(){})}else layer.msg("请先上传符合要求的图片",{time:1500});else layer.msg("请输入您的联系QQ",{time:1500});else layer.msg("请输入更高优惠券链接",{time:1500});else layer.msg("请输入举报理由",{time:1500});else layer.msg("请先选择理由",{time:1500})},jbPrdoucShut:function(){this.oHidePopup.hideJb=!1,layer.closeAll(),this.oReport.isId="",this.oReport.reportLSelected=0,this.oReport.reportL="",this.oReport.reportQQ="",this.oPublic.reportImg=""}},template:'<div class="inJu-wrap comPopupHide js-PopupReport"><div class="in-modal-inner" v-if="oHidePopup.hideJb"><p class="in-modal-hd">您确定要举报该商品吗？</p><p class="in-modal-p">请输入举报理由，我们会对商品进行相应处理</p><ul class="in-modal-list"><li><span>选择理由</span><select v-model="oReport.reportLSelected" @change="getCouponSelected(oReport.reportLSelected)"><option :value="item.id" v-for="item in oReportSelected">{{item.describe}}</option></select></li><li v-if="oReport.reportLSelected !=8"><span>举报理由</span><input type="text" maxlength="20" placeholder="请输入举报理由" v-model="oReport.reportL" :disabled="oReport.reportLSelected ==0?true:false"></li><li v-else><span>优惠券链接</span><input type="text" maxlength="20" placeholder="请输入更高优惠券链接" v-model="oReport.reportL"></li><li><span>联系Q号</span><input type="number" placeholder="请输入您的联系QQ" v-model="oReport.reportQQ" maxlength="11" ></li></ul><div class="in-modal-up"><span>上传截图</span><div class="in-modal-img" v-if="oPublic.reportImg"><img :src="oPublic.reportImg"></div><div class="in-modal-upbox"><em>+</em><input type="file" @change="ReportreadFile($event)"></div><p class="in-modal-tips" v-if="oReport.reportLSelected == 1">（截图需包含ID,评价时间和系统时间）</p></div><div class="in-modal-footer"><span class="in-modal-btn comHover-color" @click="ReportBtn()">提交</span><span class="in-modal-btn comHover-color" @click="jbPrdoucShut()">取消</span></div></div></div>'}),Vue.component("component-feedback",{mixins:[vmminxShopData],data:function(){return{oPublic:{reportImg:""},oFeedback:{accountsId:"",qq:"",feedback:""},oHidePopup:{hideFeedback:!1},oToken:{token:"",toeknTime:"",toeknBoolean:!1}}},methods:{feedbackSubBtn:function(){var self=this;""!=self.oFeedback.feedback&&""!=self.oFeedback.qq?self.oFeedback.feedback.length<5?layer.msg("建议反馈字数为5以上！",{time:2e3}):vmAjaxPost("/indexapi/api_get_advise",{seller_id:self.oFeedback.accountsId,advise_qq:self.oFeedback.qq,advise_problem:self.oFeedback.feedback,advise_photo:self.oPublic.reportImg},function(data){"200"==data.status?(self.feedbackShut(),layer.msg(data.message,{icon:1,time:2e3})):(self.feedbackShut(),layer.msg(data.message,{icon:2,time:2e3}))},function(){}):layer.msg("请输入您宝贵的建议或者QQ！",{time:2e3})},feedbackBtn:function(){this.oHidePopup.hideFeedback=!0,this.publicPopup(".js-Popupfeedback"),this.ajaxGetToken()},feedbackShut:function(){this.oHidePopup.hideFeedback=!1,this.publicClose(),this.oFeedback.accountsId="",this.oFeedback.qq="",this.oFeedback.feedback="",this.oPublic.reportImg=""}},template:'<div class="infeedback comPopupHide js-Popupfeedback"><div class="infeedback-inner" v-if="oHidePopup.hideFeedback"><div class="infeedback-t"><i>您的建议</i><em class="iconfont hdk-chenghao comHover-color" @click="feedbackShut()"></em></div><ul class="infeedback-list"><li><span>好品推帐号ID：</span><input type="text" placeholder="请输入放单账号ID(选填，没有可不填)" v-model="oFeedback.accountsId"></li><li><span>建议人QQ：</span><input type="number" placeholder="请输入您的QQ" maxlength="11" v-model="oFeedback.qq"></li><li><span>你的建议：</span><textarea placeholder="请至少输入5个字" class="infeedback-text" v-model.trim="oFeedback.feedback"></textarea></li><li><span>上传图片：</span><img :src="oPublic.reportImg" v-if="oPublic.reportImg"><div class="infeedback-upImg"><input type="file" @change="ReportreadFile($event)"><i class="iconfont hdk-jia1"></i></div></li></ul><em class="infeedSub" @click="feedbackSubBtn()">提交</em></div></div>'}),Vue.component("component-video",{data:function(){return{oHidePopup:{hideVideo:!1},oVideo:{mp4link:"",swfLlink:"",videoTab:0}}},methods:{playVideoBtn:function(id){this.oVideo.mp4link="http://cloud.video.taobao.com/play/u/1/p/1/e/6/t/1/"+id+".mp4",this.oVideo.swfLlink="//cloud.video.taobao.com/play/u/2599950707/p/1/e/1/t/1/"+id+".swf",this.oHidePopup.hideVideo=!0,layer.open({type:1,shift:0,title:!1,closeBtn:0,shade:.4,content:$(".js-popupVideo")})},videoTabBtn:function(index){this.oVideo.videoTab=index},playVideoShut:function(){this.oVideo.videoTab=0,this.oVideo.mp4link="",this.oVideo.swfLlink="",this.oHidePopup.hideVideo=!1,layer.closeAll()}},template:'<div class="video-modal-dialog comPopupHide js-popupVideo"><div v-if="oHidePopup.hideVideo"><div class="video-modal-hd"><span>查看视频</span><i class="iconfont hdk-close" @click="playVideoShut()"></i></div><div class="video-modal-bd"><div class="video-show"><video class="video-box" autoplay="autoplay" :src="oVideo.mp4link" controls="controls" v-if="oVideo.videoTab == 0"></video><object class="video-box" type="application/x-shockwave-flash" :data="oVideo.swfLlink"  v-if="oVideo.videoTab == 1"></object></div></div><div class="video-modal-footer"><span>下载视频请右键点击“视频另存为(V)...”</span><div class="video-btns"><span class="video_source" :class="[oVideo.videoTab == 0?\'video-active\':\'\']" @click="videoTabBtn(0)">视频源1</span><span class="video_source" :class="[oVideo.videoTab == 1?\'video-active\':\'\']" @click="videoTabBtn(1)">视频源2</span></div></div></div></div> '}),Vue.component("component-loading",{props:["vmpublicc"],data:function(){return{}},methods:{},template:'<div class="loadingBox" v-if="vmpublicc"><div class="loading overall-loading"><div class="outer"></div><div class="inner"></div><div class="loading-text">数据加载中，请稍后...</div></div></div>'}),Vue.component("component-datanull",{props:["vmdatanull","vmmsg","vmrescreen","vmnullimg"],data:function(){return{nullImg0:"/Public/assets/home/images/item/Index-null.png"}},methods:{resBtn:function(){this.$emit("vmresbtn")}},template:'<div class="inNull animatedFade animatedNaneBottom" v-if="vmdatanull"><img :src="nullImg0" class=" comUser-select" v-if="vmnullimg ==undefined"><p>{{vmmsg ==undefined?"抱歉，暂时没有筛选到合适商品":vmmsg}}</p><span v-if="vmmsg ==undefined">我们会努力寻找更多的商品哦~</span><em @click="resBtn" v-if="vmrescreen">重新筛选</em></div>'}),Vue.component("component-page",{props:["publiclist"],data:function(){return{}},methods:{pagebtn:function(){this.$emit("pagejump")},pagesurebtn:function(){this.$emit("pagesurebtn")}},template:'<div class="inPage-wrap vmpage" v-if="publiclist.count >1"><div class="inPage"></div><div class="inPage-y"><span @click="pagebtn()" v-if="publiclist.count != publiclist.pageNumber">{{publiclist.count}}</span><em>共{{publiclist.count}}页</em></div><p class="inPage-input"><em>到第</em><input type="number" v-model="publiclist.pageInput"  @keyup.enter="pagesurebtn()"><i>页</i><span class="comHover-color" @click="pagesurebtn()">确定</span></p></div>'}),Vue.component("component-rightfixed",{mixins:[vmminxShopData],props:["publiclist","opublic","nocopy"],data:function(){return{}},mounted:function(){},methods:{clickpagebtn:function(number){this.$emit("clickpage",number)},feedbackbtn:function(){this.$emit("feedbackbtn")},copyAllBtn:function(){var clipboard_all=new ClipboardJS(".copy_all",{target:function(trigger){return document.querySelector(".all_article")}});clipboard_all.on("success",function(e){$("#all_article").html(""),layer.msg("复制成功！",{icon:1,tiem:2e3}),e.clearSelection()}),clipboard_all.on("error",function(e){$("#all_article").html(""),layer.msg("由于您的浏览器不兼容或当前网速较慢，复制失败，请手动复制或更换主流浏览器！",{icon:2})});var all_content="";$(".fq-copy").each(function(){content=$(this).attr("datatips"),all_content=all_content+content+"<br/>"}),$("#all_article").html(all_content)}},template:'<div class="inFixed comUser-select"><p class="inFixed-page">{{publiclist.pageNumber}}/{{publiclist.count}}</p><div class="inFixed-box"><a href="javascript:" @click="clickpagebtn(-1)" v-if="!opublic.loadingShow && publiclist.pageNumber != 1">向上一页</a><a href="javascript:" class="js-noClick" v-else>向上一页</a><a href="javascript:" @click="clickpagebtn(+1)" v-if="!opublic.loadingShow && publiclist.count != publiclist.pageNumber">向下一页</a><a href="javascript:" class="js-noClick" v-else>向下一页</a><a href="/index/help_index.html" target="_blank">帮助中心</a><a href="javascript:" @click="feedbackbtn()">建议反馈</a><a href="javascript:" id="contact_service">联系客服</a><a href="javascript:" class="copy_all" @click="copyAllBtn()" v-if="nocopy==undefined">一键复制</a><div class="contact-kefu"><img src="" alt="好品推公众号"><div class="contact-tips"><span>关注好品推公众号</span> <span>向在线客服提问</span></div></div></div><i class="inFixed-arrowTop" @click="arrowTopFun()"></i></div>'}),Vue.component("component-brandicon",{mixins:[vmminxShopData],props:["item"],data:function(){return{}},methods:{},template:'<div style="display:inline-block"><span class="inProduc-l-Tm" v-if="item.shoptype==\'B\'" @mouseenter="moveinIcon(\'天猫\',$event)" @mouseleave="ComremoveLayerTips()"></span><span v-if="item.shoptype==\'C\'" @mouseenter="moveinIcon(\'淘宝\',$event)" @mouseleave="ComremoveLayerTips()">淘</span><span v-if="item.is_foreshow == 2" @mouseenter="moveinIcon(\'快抢\',$event)" @mouseleave="ComremoveLayerTips()">快</span><span v-if="item.videoid == 2" @mouseenter="moveinIcon(\'视频\',$event)" @mouseleave="ComremoveLayerTips()">视</span><span v-if="item.activity_type == \'淘抢购\'" @mouseenter="moveinIcon(\'淘抢购\',$event)" @mouseleave="ComremoveLayerTips()">抢</span><span v-if="item.activity_type == \'聚划算\'" @mouseenter="moveinIcon(\'聚划算\',$event)"  @mouseleave="ComremoveLayerTips()">聚</span><span v-if="item.is_brand == 1" @mouseenter="moveinIcon(\'品牌单\',$event)" @mouseleave="ComremoveLayerTips()">品</span><div class="inIconActive" v-if="item.activity_plan !=0"><img :src="iconItem.img" v-for="(iconItem,index) in item.activity_info" @mouseenter="moveinIcon(iconItem.name,$event)" @mouseleave="ComremoveLayerTips()"></div></div>'}),Vue.component("vmPic",{props:["goodsid"],data:function(){return{loadmsg:!0,cacheId:"",realPicoPage:{pageNumber:1,pageImgAll:[]}}},mounted:function(){var self=this,nScrollHight=0,nScrollTop=0,nDivHight=$(".realpic-box").height();$(".realpic-box").scroll(function(){nScrollHight=$(this)[0].scrollHeight,nScrollTop=$(this)[0].scrollTop,nScrollHight<=nScrollTop+nDivHight&&self.loadmsg&&self.ajaxIrealpic()})},methods:{ajaxIrealpic:function(abs){var self=this;if(abs){if(self.cacheId==self.goodsid&&""!=self.realPicoPage.pageImgAll)return void self.CallbackRealpic();self.realPicoPage={pageNumber:1,pageImgAll:[]},self.loadmsg=!0,layer.load(2,{shade:.1}),self.cacheId=self.goodsid}else self.realPicoPage.pageNumber+=1;vmAjaxPost("/tool/get_evaluate_imageurl",{itemid:self.goodsid,page:self.realPicoPage.pageNumber},function(data){if(layer.closeAll("loading"),"200"==data.code){if(0==data.evaluate_imageurl)return self.loadmsg=!1,void(abs&&layer.msg("没有实拍图哦",{time:1500,shade:.1,shadeClose:!0}));self.realPicoPage.pageImgAll=self.realPicoPage.pageImgAll.concat(data.evaluate_imageurl),self.realPicoPage.pageImgAll.length<6&&self.ajaxIrealpic(),self.$nextTick(function(){abs&&self.CallbackRealpic()})}else"-1"==data.code?layer.msg("请先登录",{time:1500,shade:.1,shadeClose:!0}):layer.msg(data.msg,{icon:2,shade:.1,shadeClose:!0})})},CallbackRealpic:function(){layer.open({type:1,shift:0,title:"获取实拍图",closeBtn:2,shade:.4,area:["850px","720px"],content:$(".js-realPic")})}},template:'<div class="realPic js-realPic"><div class="realpic-box"><ul class="realPic-list clearfix"><li v-for="(item,index) in realPicoPage.pageImgAll"><img :src="item"></li></ul><p class="realpic-loading" v-if="loadmsg"> <i class="iconfont hdk-jiazai vmIconLoad"></i><em>数据加载中...</em></p><p class="realpic-loading" v-else>数据已经加载完了</p></div></div>'});